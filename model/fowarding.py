import heapq
import pickle

class Forwarding:
    def __init__(self):
        self.ratingMap = pickle.load(open("./ratingMap.sav", "rb"))

    def getTopK(self, tagsList, k):
        outerHeap = []
        topKList = []
        for tag in tagsList:
            innerHeap = []
            innerMap = self.ratingMap[tag]
            for key in innerMap:
                score = innerMap[key]
                heapq.heappush(innerHeap,(-score,key))
            for _ in range(k):
                if innerHeap:
                    heapq.heappush(outerHeap, heapq.heappop(innerHeap))
        for _ in range(k):
            if outerHeap:
                topKList.append(heapq.heappop(outerHeap))
        print(topKList)
        return ["https://stackoverflow.com/users/"+str(element[1]) for element in topKList]

